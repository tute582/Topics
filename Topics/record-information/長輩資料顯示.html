<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>長輩個人資料</title>

  <style>
    /* --- 整體頁面設定 --- */
    body {
      font-family: "Segoe UI", sans-serif; /* 字型 */
      background: #f4f6f8;                /* 淺灰背景 */
      margin: 0;
      padding: 0;
    }

    /* --- 主要內容卡片 --- */
    .card {
      max-width: 720px;                   /* 最大寬度 */
      margin: 24px auto;                  /* 垂直間距 + 置中 */
      background: #fff;                   /* 白色背景 */
      padding: 20px;
      border-radius: 8px;                 /* 圓角 */
      box-shadow: 0 6px 18px rgba(0,0,0,0.08); /* 陰影 */
      text-align: center;                 /* 內容置中 */
    }

    /* --- 標題設定 --- */
    h1 {
      margin: 0 0 0 0;
      font-size: 28px;
    }

    /* --- 頭像圖片樣式 --- */
    .avatar {
      width: 120px;
      height: 120px;
      border-radius: 50%;                 /* 圓形 */
      object-fit: cover;                  /* 圖片自動裁切填滿 */
      border: 3px solid #0078d4;          /* 外框藍色 */
      margin-bottom: 0px;
    }

    /* --- 定義清單樣式 (顯示個人資料用) --- */
    dl {
      display: grid;                      /* 使用網格排版 */
      grid-template-columns: 140px 1fr;   /* 左標題欄 + 右內容欄 */
      gap: 8px 16px;                      /* 間距 */
      text-align: left;
      margin-top: 10px;
    }

    dt {
      font-weight: 700;                   /* 標題粗體 */
      color: #333;
    }

    dd {
      margin: 0;
      color: #222;
      word-break: break-word;             /* 自動換行避免溢出 */
    }

    /* --- 返回按鈕樣式 --- */
    .back {
      display: inline-block;
      margin-top: 20px;
      padding: 8px 14px;
      background: #0078d4;
      color: #fff;
      border-radius: 6px;
      text-decoration: none;              /* 移除底線 */
    }

    .empty {
      color: #666;
    }

    /* --- 導覽列(nav bar) --- */
    .nav-1 {
      display: flex;                      /* 水平排列 */
      font-weight: bold;
      align-items: center;                /* 垂直置中 */
      justify-content: space-between;     /* 左右兩端對齊 */
      padding: 10px 25px;
      position: sticky;                   /* 滾動時固定上方 */
      top: 0;
      z-index: 1001;                      /* 位於最上層 */
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      width: 100%;
      color: black;
      background-color: white;
      box-sizing: border-box;
      border-bottom: 1px solid #ddd;      /* 下邊界線 */
    }
  </style>
</head>

<body>

  <!-- 導覽列 -->
  <nav class="nav-1">
    <div>
      <h1>長輩個人資料</h1>
    </div>

    <!-- 導覽列右側顯示志工頭像與名稱 -->
    <div style="display:flex; align-items:center;">
      <h1 style="margin:0; text-align:right;">
        <span class="volunteer-area" style="display:flex; align-items:center; gap:8px;">
          <!-- 導覽列上的小頭像 -->
          <img id="avatar" class="avatar" src="default-avatar.png" alt="avatar"
               style="width:40px;height:40px;border-radius:50%;object-fit:cover;border:2px solid #0984e3;">
          <!-- 顯示志工名稱（預設未登入） -->
          <span id="volunteerName" title="點此以 Line 登入" style="cursor:pointer;">未登入</span>
        </span>
      </h1>
    </div>
  </nav>

  <!-- 主要卡片內容 -->
  <div class="card">
    <!-- 使用者頭像（卡片內的大頭像） -->
    <img id="volunteerAvatar" class="avatar" src="default-avatar.png" alt="使用者頭像">
    
    <!-- 這裡放使用者詳細資料 -->
    <div id="content"></div>

    <!-- 返回註冊頁按鈕 -->
    <a class="back" href="註冊頁面.html">回到填寫頁</a>
  </div>

  <!-- JavaScript 區域 -->
  <script>
    // 取得網頁中需要操作的元素
    const content = document.getElementById('content');             // 顯示資料內容區
    const avatar = document.getElementById('avatar');               // 導覽列頭像
    const volunteerAvatar = document.getElementById('volunteerAvatar'); // 卡片大頭像
    const raw = localStorage.getItem('seniors');                    // 從 localStorage 取資料（JSON 字串）

    // 檢查 localStorage 是否有資料
    if (!raw) {
      // 沒有資料的情況
      content.innerHTML = '<p class="empty">目前沒有任何使用者資料。</p>';
    } else {
      try {
        // 將 JSON 字串轉為物件陣列
        const list = JSON.parse(raw);

        // 取出最後一筆資料（最新填寫者）
        const d = list[list.length - 1];

        // 若沒有上傳頭像，使用預設圖
        const photo = d.avatar && d.avatar.trim() !== "" ? d.avatar : "default-avatar.png";

        // 導覽列頭像、卡片頭像都顯示這張圖
        avatar.src = photo;
        volunteerAvatar.src = photo;

        // 導覽列名稱顯示長輩姓名（若無則顯示未登入）
        volunteerName.textContent = d.name || "未登入";

        // 建立要顯示的個人資料 HTML 結構
        const html = [
          '<dl>',
            `<dt>姓名</dt><dd>${d.name || ''}</dd>`,
            `<dt>連絡電話</dt><dd>${d.phone || ''}</dd>`,
            `<dt>出生年月日</dt><dd>${d.birthday || ''}</dd>`,
            `<dt>性別</dt><dd>${d.gender || ''}</dd>`,
            `<dt>地址</dt><dd>${d.address || ''}</dd>`,
            `<dt>緊急聯絡人</dt><dd>${d.emergencyContact || ''}</dd>`,
            `<dt>健康狀況備註</dt><dd>${d.healthNote || ''}</dd>`,
          '</dl>'
        ].join('');

        // 插入網頁中顯示
        content.innerHTML = html;

      } catch (e) {
        // JSON 解析錯誤處理
        console.error("資料解析錯誤:", e);
        content.innerHTML = '<p class="empty">資料解析錯誤。</p>';
      }
    }
  </script>
</body>
</html>
